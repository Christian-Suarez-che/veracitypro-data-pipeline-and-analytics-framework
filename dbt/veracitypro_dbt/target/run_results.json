{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2025.9.26+e453d56", "generated_at": "2025-09-30T07:18:01.438954Z", "invocation_id": "6994ee03-cb59-4ae9-b565-eadbac483507", "invocation_started_at": "2025-09-30T07:17:57.491790Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.161002Z", "completed_at": "2025-09-30T07:17:59.179972Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.221325Z", "completed_at": "2025-09-30T07:17:59.499377Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.34638142585754395, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3667-0067-5f8b000340de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_keepa_price_events", "compiled": true, "compiled_code": "-- Keepa: price timeline (priceEvents)\n-- Robust timestamp handling + safe numeric casts\nwith src as (\n  select\n    payload,\n    ingest_dt,\n    payload:\"asin\"::string as asin\n  from VP_DWH.RAW.KEEPA_RAW\n),\nevents as (\n  select\n    s.asin,\n\n    /* event_ts can be ISO string or epoch (s/ms) */\n    case\n      when try_to_timestamp((e.value:\"ts\")::string) is not null\n        then try_to_timestamp((e.value:\"ts\")::string)\n      when try_to_number((e.value:\"ts\")::string) >= 100000000000    -- >= 1e11 \u2192 likely ms\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) / 1000 )\n      when try_to_number((e.value:\"ts\")::string) is not null\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) )\n      else null\n    end as event_ts,\n\n    try_to_number((e.value:\"price\")::string) as price_cents,\n    s.ingest_dt\n  from src s,\n  lateral flatten(input => s.payload:\"priceEvents\") e\n)\nselect\n  asin,\n  event_ts,\n  case when price_cents is not null then price_cents / 100.0 end as price_usd,\n  ingest_dt\nfrom events\nwhere event_ts is not null", "relation_name": "VP_DWH.STG.stg_keepa_price_events", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.169745Z", "completed_at": "2025-09-30T07:17:59.178258Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.180381Z", "completed_at": "2025-09-30T07:17:59.908978Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7529525756835938, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-365d-0067-5f8b000320ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_keepa_rating_events", "compiled": true, "compiled_code": "-- Keepa: rating timeline (ratingEvents)\nwith src as (\n  select\n    payload,\n    ingest_dt,\n    payload:\"asin\"::string as asin\n  from VP_DWH.RAW.KEEPA_RAW\n),\nevents as (\n  select\n    s.asin,\n\n    case\n      when try_to_timestamp((e.value:\"ts\")::string) is not null\n        then try_to_timestamp((e.value:\"ts\")::string)\n      when try_to_number((e.value:\"ts\")::string) >= 100000000000\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) / 1000 )\n      when try_to_number((e.value:\"ts\")::string) is not null\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) )\n      else null\n    end as event_ts,\n\n    try_to_number((e.value:\"rating\")::string) as rating,\n    try_to_number((e.value:\"count\")::string)  as ratings_count,\n    s.ingest_dt\n  from src s,\n  lateral flatten(input => s.payload:\"ratingEvents\") e\n)\nselect asin, event_ts, rating, ratings_count, ingest_dt\nfrom events\nwhere event_ts is not null", "relation_name": "VP_DWH.STG.stg_keepa_rating_events", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.173488Z", "completed_at": "2025-09-30T07:17:59.218937Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.225768Z", "completed_at": "2025-09-30T07:17:59.914466Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.7562994956970215, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3672-0067-5f8b0003a0de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_scraper_product", "compiled": true, "compiled_code": "-- ScraperAPI: product page snapshot\nwith src as (\n  select payload, ingest_dt\n  from VP_DWH.RAW.SCRAPERAPI_RAW\n)\nselect\n  payload:\"asin\"::string                  as asin,\n  payload:\"title\"::string                 as title,\n  payload:\"brand\"::string                 as brand,\n  payload:\"category\"::string              as category,\n  try_to_number((payload:\"price\")::string) as scraped_price,\n  try_to_timestamp((payload:\"scraped_at\")::string) as scraped_at,\n  ingest_dt\nfrom src", "relation_name": "VP_DWH.STG.stg_scraper_product", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.167811Z", "completed_at": "2025-09-30T07:17:59.178645Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.185794Z", "completed_at": "2025-09-30T07:17:59.945287Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7900478839874268, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3672-0067-5f8b0003a0e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_keepa_rank_events", "compiled": true, "compiled_code": "-- Keepa: sales rank timeline (rankEvents)\nwith src as (\n  select\n    payload,\n    ingest_dt,\n    payload:\"asin\"::string as asin\n  from VP_DWH.RAW.KEEPA_RAW\n),\nevents as (\n  select\n    s.asin,\n\n    case\n      when try_to_timestamp((e.value:\"ts\")::string) is not null\n        then try_to_timestamp((e.value:\"ts\")::string)\n      when try_to_number((e.value:\"ts\")::string) >= 100000000000\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) / 1000 )\n      when try_to_number((e.value:\"ts\")::string) is not null\n        then to_timestamp_ntz( try_to_number((e.value:\"ts\")::string) )\n      else null\n    end as event_ts,\n\n    try_to_number((e.value:\"rank\")::string) as sales_rank,\n    s.ingest_dt\n  from src s,\n  lateral flatten(input => s.payload:\"rankEvents\") e\n)\nselect asin, event_ts, sales_rank, ingest_dt\nfrom events\nwhere event_ts is not null", "relation_name": "VP_DWH.STG.stg_keepa_rank_events", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.171422Z", "completed_at": "2025-09-30T07:17:59.178991Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.219332Z", "completed_at": "2025-09-30T07:18:00.027089Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.8702418804168701, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3604-0067-5f8b0002c242"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_scraper_offers", "compiled": true, "compiled_code": "-- ScraperAPI: offers snapshot (array -> rows)\nwith src as (\n  select payload\n  from VP_DWH.RAW.SCRAPERAPI_RAW\n),\noffers as (\n  select\n    src.payload:\"asin\"::string                          as asin,\n    try_to_timestamp((src.payload:\"scraped_at\")::string) as snapshot_ts,\n    o.value:\"sold_by\"::string                           as sold_by,\n    o.value:\"ships_from\"::string                        as ships_from,\n    try_to_number((o.value:\"price\")::string)            as price,\n    try_to_number(coalesce((o.value:\"shipping_price\")::string, '0')) as shipping_price,\n    coalesce(o.value:\"has_prime\"::boolean, false)       as has_prime_shipping,\n    coalesce(o.value:\"is_fba\"::boolean, false)          as is_fba\n  from src,\n  lateral flatten(input => src.payload:\"offers\") o\n)\nselect * from offers", "relation_name": "VP_DWH.STG.stg_scraper_offers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.175908Z", "completed_at": "2025-09-30T07:17:59.196169Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.223261Z", "completed_at": "2025-09-30T07:18:00.063469Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.9044463634490967, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3669-0067-5f8b00039106"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.veracitypro_dbt.stg_spapi_orders", "compiled": true, "compiled_code": "-- SP-API: Orders + OrderItems flattened to one row per (order_id, asin)\nwith src as (\n  select payload, ingest_dt\n  from VP_DWH.RAW.SPAPI_RAW\n),\norders as (\n  select\n    payload:\"AmazonOrderId\"::string                     as order_id,\n    try_to_timestamp((payload:\"PurchaseDate\")::string)  as purchase_ts,\n    payload:\"OrderStatus\"::string                       as order_status,\n    payload:\"MarketplaceId\"::string                     as marketplace_id,\n    payload                                             as payload_full,\n    ingest_dt\n  from src\n),\nitems as (\n  select\n    o.order_id,\n    i.value:\"ASIN\"::string                                 as asin,\n    try_to_number((i.value:\"QuantityOrdered\")::string)     as qty,\n    try_to_number((i.value:\"ItemPrice\":\"Amount\")::string)  as item_price,\n    o.purchase_ts,\n    o.order_status,\n    o.marketplace_id,\n    o.ingest_dt\n  from orders o,\n       lateral flatten(input => o.payload_full:\"OrderItems\", outer => true) i\n  where i.value is not null   -- keep only rows where we actually have an item\n)\nselect * from items", "relation_name": "VP_DWH.STG.stg_spapi_orders", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.518601Z", "completed_at": "2025-09-30T07:17:59.536801Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.538198Z", "completed_at": "2025-09-30T07:18:00.077019Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5655550956726074, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3676-0067-5f8b000370ca"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.dbt_utils_unique_combination_of_columns_stg_keepa_price_events_asin__event_ts.a4eff4b550", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        asin, event_ts\n    from VP_DWH.STG.stg_keepa_price_events\n    group by asin, event_ts\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.918423Z", "completed_at": "2025-09-30T07:17:59.932987Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.933491Z", "completed_at": "2025-09-30T07:18:00.194098Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2779719829559326, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3672-0067-5f8b0003a0e6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_price_events_asin.b2408a9222", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_keepa_price_events\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.928023Z", "completed_at": "2025-09-30T07:17:59.935157Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.935638Z", "completed_at": "2025-09-30T07:18:00.211257Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.2843446731567383, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3667-0067-5f8b000340e2"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_price_events_event_ts.0da18df8b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_ts\nfrom VP_DWH.STG.stg_keepa_price_events\nwhere event_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:17:59.951073Z", "completed_at": "2025-09-30T07:17:59.959390Z"}, {"name": "execute", "started_at": "2025-09-30T07:17:59.960089Z", "completed_at": "2025-09-30T07:18:00.226855Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2771291732788086, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6455-0000-3667-0067-5f8b000340e6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_price_events_price_usd.ec8a8b5c5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price_usd\nfrom VP_DWH.STG.stg_keepa_price_events\nwhere price_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.030928Z", "completed_at": "2025-09-30T07:18:00.036692Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.037131Z", "completed_at": "2025-09-30T07:18:00.247565Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.217529296875, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3667-0067-5f8b000340ea"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.dbt_utils_unique_combination_of_columns_stg_keepa_rating_events_asin__event_ts.53f2b982ec", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        asin, event_ts\n    from VP_DWH.STG.stg_keepa_rating_events\n    group by asin, event_ts\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.067737Z", "completed_at": "2025-09-30T07:18:00.077601Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.079040Z", "completed_at": "2025-09-30T07:18:00.314357Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.24778437614440918, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-365d-0067-5f8b000320f2"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_rating_events_asin.7b36898b8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_keepa_rating_events\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.082589Z", "completed_at": "2025-09-30T07:18:00.089795Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.090510Z", "completed_at": "2025-09-30T07:18:00.361689Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2800750732421875, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3675-0067-5f8b00038106"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_rating_events_event_ts.cd426fa902", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_ts\nfrom VP_DWH.STG.stg_keepa_rating_events\nwhere event_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.214284Z", "completed_at": "2025-09-30T07:18:00.219404Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.219814Z", "completed_at": "2025-09-30T07:18:00.383487Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.17008638381958008, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3676-0067-5f8b000370ce"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_scraper_product_scraped_at.0c69cba975", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect scraped_at\nfrom VP_DWH.STG.stg_scraper_product\nwhere scraped_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.251905Z", "completed_at": "2025-09-30T07:18:00.259059Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.259560Z", "completed_at": "2025-09-30T07:18:00.393917Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14289546012878418, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3676-0067-5f8b000370d2"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_rank_events_asin.41a7b3ca4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_keepa_rank_events\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.231974Z", "completed_at": "2025-09-30T07:18:00.240740Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.241436Z", "completed_at": "2025-09-30T07:18:00.415548Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1849980354309082, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3676-0067-5f8b000370d6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.dbt_utils_unique_combination_of_columns_stg_keepa_rank_events_asin__event_ts.7240a56d98", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        asin, event_ts\n    from VP_DWH.STG.stg_keepa_rank_events\n    group by asin, event_ts\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.197222Z", "completed_at": "2025-09-30T07:18:00.202804Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.203231Z", "completed_at": "2025-09-30T07:18:00.429207Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2328627109527588, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3604-0067-5f8b0002c246"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_scraper_product_asin.959d39924f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_scraper_product\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.317399Z", "completed_at": "2025-09-30T07:18:00.322922Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.323351Z", "completed_at": "2025-09-30T07:18:00.486778Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.17026662826538086, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3604-0067-5f8b0002c24a"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_keepa_rank_events_event_ts.fd1ca1d59e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_ts\nfrom VP_DWH.STG.stg_keepa_rank_events\nwhere event_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.365078Z", "completed_at": "2025-09-30T07:18:00.376267Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.376702Z", "completed_at": "2025-09-30T07:18:00.681539Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3173489570617676, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3571-0067-5f8b0002331e"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.dbt_utils_unique_combination_of_columns_stg_scraper_offers_asin__snapshot_ts__sold_by.e77fecd14a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        asin, snapshot_ts, sold_by\n    from VP_DWH.STG.stg_scraper_offers\n    group by asin, snapshot_ts, sold_by\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.489800Z", "completed_at": "2025-09-30T07:18:00.498553Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.498991Z", "completed_at": "2025-09-30T07:18:00.703078Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.21416211128234863, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3676-0067-5f8b000370da"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.dbt_utils_unique_combination_of_columns_stg_spapi_orders_order_id__asin.7ac1441a64", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, asin\n    from VP_DWH.STG.stg_spapi_orders\n    group by order_id, asin\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.432495Z", "completed_at": "2025-09-30T07:18:00.462858Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.463313Z", "completed_at": "2025-09-30T07:18:00.847573Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4159691333770752, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3673-0067-5f8b00036132"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.accepted_values_stg_spapi_orders_order_status__True__Pending__Unshipped__PartiallyShipped__Shipped__Canceled__Unfulfillable__InvoiceUnconfirmed__PendingAvailability.0743282f65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status as value_field,\n        count(*) as n_records\n\n    from VP_DWH.STG.stg_spapi_orders\n    group by order_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Pending','Unshipped','PartiallyShipped','Shipped','Canceled','Unfulfillable','InvoiceUnconfirmed','PendingAvailability'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.706117Z", "completed_at": "2025-09-30T07:18:00.711308Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.711724Z", "completed_at": "2025-09-30T07:18:00.870427Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.16518306732177734, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3673-0067-5f8b00036136"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_spapi_orders_order_id.0d582cd929", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom VP_DWH.STG.stg_spapi_orders\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.850806Z", "completed_at": "2025-09-30T07:18:00.857154Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.857592Z", "completed_at": "2025-09-30T07:18:00.981415Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13152813911437988, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-365d-0067-5f8b000320f6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_spapi_orders_qty.f90d45def9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect qty\nfrom VP_DWH.STG.stg_spapi_orders\nwhere qty is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.684718Z", "completed_at": "2025-09-30T07:18:00.690348Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.690780Z", "completed_at": "2025-09-30T07:18:00.997295Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3135042190551758, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3606-0067-5f8b0002e1b6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_spapi_orders_asin.ea87aacfb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_spapi_orders\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.399338Z", "completed_at": "2025-09-30T07:18:00.406135Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.406600Z", "completed_at": "2025-09-30T07:18:01.136138Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.7394149303436279, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-360f-0067-5f8b000301f6"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_scraper_offers_snapshot_ts.770532025c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect snapshot_ts\nfrom VP_DWH.STG.stg_scraper_offers\nwhere snapshot_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.418419Z", "completed_at": "2025-09-30T07:18:00.423387Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.423809Z", "completed_at": "2025-09-30T07:18:01.145428Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7278337478637695, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-360f-0067-5f8b000301fa"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_scraper_offers_sold_by.58b0030469", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sold_by\nfrom VP_DWH.STG.stg_scraper_offers\nwhere sold_by is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.386459Z", "completed_at": "2025-09-30T07:18:00.396170Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.397271Z", "completed_at": "2025-09-30T07:18:01.155729Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.7701046466827393, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-360f-0067-5f8b000301f2"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.not_null_stg_scraper_offers_asin.ed4d228501", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect asin\nfrom VP_DWH.STG.stg_scraper_offers\nwhere asin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-30T07:18:00.873436Z", "completed_at": "2025-09-30T07:18:00.875569Z"}, {"name": "execute", "started_at": "2025-09-30T07:18:00.876014Z", "completed_at": "2025-09-30T07:18:01.159006Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.286480188369751, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf6456-0000-3666-0067-5f8b00033102"}, "message": null, "failures": 0, "unique_id": "test.veracitypro_dbt.test_qty_positive", "compiled": true, "compiled_code": "-- Fails if quantity is null or <= 0\nselect *\nfrom VP_DWH.STG.stg_spapi_orders\nwhere qty is null or qty <= 0", "relation_name": null, "batch_results": null}], "elapsed_time": 3.091726779937744, "args": {"profiles_dir": "./", "empty": false, "partial_parse_file_diff": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "exclude_resource_types": [], "use_colors": true, "strict_mode": false, "resource_types": [], "defer": false, "validate_macro_args": false, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt ", "show_resource_report": false, "log_level": "debug", "exclude": [], "log_path": "logs", "version_check": true, "use_fast_test_edges": false, "upload_to_artifacts_ingest_api": false, "require_generic_test_arguments_property": true, "require_resource_names_without_spaces": true, "project_dir": "/app/dbt_project/1cedfce5-fb2a-4272-b851-6a13498a08b5", "quiet": false, "source_freshness_run_project_hooks": true, "log_file_max_bytes": 0, "macro_debugging": false, "favor_state": false, "log_level_file": "debug", "skip_write_msgpack_if_exist": false, "profile": "user", "select": ["path:models/stg"], "state_modified_compare_more_unrendered_values": false, "vortex_event_forwarding_enabled": false, "require_yaml_configuration_for_mf_time_spines": false, "require_nested_cumulative_type_params": false, "show_all_deprecations": false, "send_anonymous_usage_stats": true, "printer_width": 80, "state_modified_compare_vars": false, "show": false, "partial_parse": true, "skip_semantic_layer": false, "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "export_saved_queries": false, "cache_selected_only": false, "log_format": "json", "populate_cache": true, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "use_colors_file": true, "static_parser": true, "write_json": true, "require_all_warnings_handled_by_warn_error": false, "which": "build", "print": true, "include_saved_query": false, "log_format_file": "json", "target_path": "target"}}